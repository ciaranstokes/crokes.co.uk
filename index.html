<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rezlynx Repository</title>
    <!-- Favicon -->
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='50%25' y='85%25' style='font-size:90px;text-anchor:middle;'%3E%E2%9A%A1%3C/text%3E%3C/svg%3E" type="image/svg+xml">    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- General Super App Styles --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #faf5ff;
        }
        .card {
            box-shadow: 0 10px 30px -5px rgba(109, 40, 217, 0.1), 0 4px 10px -2px rgba(109, 40, 217, 0.05);
            border-width: 1px;
            border-radius: 1.5rem;
        }
        input[type="date"]::-webkit-calendar-picker-indicator {
            opacity: 0;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            cursor: pointer;
        }
        input[type="date"] {
            appearance: none;
            -moz-appearance: none;
            position: relative;
            padding-right: 3rem;
        }
        .app-content {
            display: none; /* All app views are hidden by default */
        }
        .app-content.active {
            display: block; /* The active app view is shown */
        }
        .nav-button.active {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        /* --- HK Plan Generator Styles --- */
        .control-area {
            border-radius: 1.5rem;
            padding: 1.5rem;
            background-color: white;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            border: 1px solid #e0f2fe;
        }
        .compact-display span {
            font-size: 1rem;
            font-weight: 600;
        }

        /* --- Front Hall Specific Styles --- */
        .source-badge {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 9999px;
            font-weight: 700;
            text-transform: uppercase;
            display: inline-block;
        }
        .source-booking { background-color: #003580; color: white; }
        .source-expedia { background-color: #FFC20E; color: black; }
        .source-direct { background-color: #059669; color: white; }
        .source-other { background-color: #6b7280; color: white; }
        
        .note-line {
            display: block;
            font-size: 0.85rem;
            margin-top: 2px;
            color: #374151;
        }
        .note-label {
            font-weight: 700;
            color: #4b5563;
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        /* --- Print Specific Styles --- */
        @media print {
            body {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                background-color: #ffffff !important;
                font-size: 10pt;
            }
            .no-print { display: none !important; }

            /* HK Plan Print */
            #print-table-container { display: block !important; }
            .print-table-classic { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
            .floor-section-print { page-break-inside: avoid; margin-bottom: 2rem; }
            .print-table-classic th, .print-table-classic td {
                border: 1px solid #334155;
                padding: 0.3rem;
                text-align: center;
                font-size: 11px;
                color: black !important;
            }
            .print-table-classic th { font-weight: bold; font-size: 12px; }
            .print-table-classic th:first-child, .print-table-classic td:first-child {
                background-color: #f1f5f9 !important;
                text-align: left;
                font-weight: bold;
            }

            /* Kitchen Products Print */
            @page { size: A4 portrait; margin: 0.4in 0.75in; }
            #kitchen-app-container #results, #kitchen-app-container #results * { visibility: visible; }
            #kitchen-app-container #results { position: absolute; left: 0; top: 0; width: 100%; padding: 0; }
            #kitchen-app-container #reportTitle { display: block !important; color: #581c87 !important; text-align: center; font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem; }
            #kitchen-app-container table { width: 100%; border-collapse: separate; border-spacing: 0; }
            #kitchen-app-container thead { background-color: #fae8ff !important; }
            #kitchen-app-container th { padding: 12px 24px; text-align: center; font-size: 0.9rem; font-weight: bold; color: #581c87 !important; text-transform: uppercase; letter-spacing: 0.05em; border: none; }
            #kitchen-app-container th:first-child { border-top-left-radius: 1rem; }
            #kitchen-app-container th:last-child { border-top-right-radius: 1rem; }
            #kitchen-app-container td { padding: 16px 24px; text-align: center; font-size: 1rem; border-bottom: 1px solid #fae8ff; color: #1f2937; }
            #kitchen-app-container tr:last-child td { border-bottom: none; }
        }
    </style>
</head>
<body class="p-4 sm:p-1 min-h-screen">

    <div class="max-w-screen-2xl mx-auto">
        
        <!-- Navigation Links Card -->
        <div class="card bg-white p-4 sm:p-6 rounded-3xl border-violet-100 mt-6 md:mt-12 no-print">
            <div id="main-nav" class="grid grid-cols-2 md:grid-cols-5 gap-4">
                <a href="#" data-target="home-app" class="nav-button bg-gray-500 text-white font-bold h-20 rounded-2xl hover:bg-gray-600 transition duration-150 shadow-md transform hover:scale-[1.03] active:scale-[0.98] flex items-center justify-center p-2 active">
                    <span class="text-center">Home Hub</span>
                </a>
                <a href="#" data-target="breakfast-app" class="nav-button bg-emerald-500 text-white font-bold h-20 rounded-2xl hover:bg-emerald-600 transition duration-150 shadow-md transform hover:scale-[1.03] active:scale-[0.98] flex items-center justify-center p-2">
                    <span class="text-center">Breakfast List</span>
                </a>
                <a href="#" data-target="kitchen-app" class="nav-button bg-pink-500 text-white font-bold h-20 rounded-2xl hover:bg-pink-600 transition duration-150 shadow-md transform hover:scale-[1.03] active:scale-[0.98] flex items-center justify-center p-2">
                    <span class="text-center">Kitchen List</span>
                </a>
                <a href="#" data-target="hk-app" class="nav-button bg-sky-500 text-white font-bold h-20 rounded-2xl hover:bg-sky-600 transition duration-150 shadow-md transform hover:scale-[1.03] active:scale-[0.98] flex items-center justify-center p-2">
                    <span class="text-center">Housekeeping Plan</span>
                </a>
                <!-- NEW FRONT HALL BUTTON -->
                <a href="#" data-target="fronthall-app" class="nav-button bg-orange-500 text-white font-bold h-20 rounded-2xl hover:bg-orange-600 transition duration-150 shadow-md transform hover:scale-[1.03] active:scale-[0.98] flex items-center justify-center p-2">
                    <span class="text-center">Front Hall</span>
                </a>
            </div>
        </div>

        <!-- App Content Area -->
        <div class="mt-8">

            <!-- HOME / MASTER HUB APP -->
            <div id="home-app" class="app-content active">
                 <div class="w-full mb-12">
                    <div class="card bg-white p-12 sm:p-16 rounded-3xl border-violet-100 flex flex-col justify-center items-center text-center shadow-lg">
                        <h2 class="text-4xl font-extrabold text-gray-800 mb-6 tracking-tight">Welcome</h2>
                        <p class="text-2xl text-gray-600 font-medium">Mews is dead long live the king</p>
                    </div>
                </div>
            </div>

            <!-- BREAKFAST TRACKER APP -->
            <div id="breakfast-app" class="app-content">
                <div class="container mx-auto px-4 py-8 lg:py-12">
                    <header class="text-center mb-8 lg:mb-12 no-print">
                        <div class="inline-flex items-center justify-center gap-3 bg-green-100 text-green-800 px-6 py-3 rounded-3xl hover:bg-green-200 transition duration-150 shadow-md">
                             <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">Breakfast List</h1>
                        </div>
                    </header>
                    <main class="bg-white/70 backdrop-blur-sm p-6 lg:p-8 rounded-3xl shadow-xl shadow-green-200/50">
                        <div class="grid grid-cols-1 lg:grid-cols-2 lg:gap-8">
                            <div class="flex flex-col gap-6 no-print">
                                <div class="bg-white p-6 rounded-2xl border border-gray-200/80">
                                    <label for="orderData" class="block text-sm font-bold text-green-800 mb-2">Breakfast Data (Paste Here)</label>
                                    <textarea id="orderData" oninput="breakfast_calculateTotal()" rows="4" class="w-full p-4 bg-gray-50 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-green-300 focus:border-green-400" placeholder="Paste Rezlynx data here..."></textarea>
                                </div>
                                <div class="bg-green-100 p-6 rounded-2xl text-center border border-green-200">
                                    <h2 class="text-lg font-semibold text-green-800 mb-2">Total Breakfasts</h2>
                                    <p id="totalAmount" class="text-6xl font-extrabold text-green-600">0</p>
                                </div>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <button onclick="breakfast_print()" class="bg-green-500 text-white font-bold py-4 px-4 rounded-2xl hover:bg-green-600 transition-all">Print Report</button>
                                    <button onclick="breakfast_clearData()" class="bg-gray-400 text-white font-bold py-4 px-4 rounded-2xl hover:bg-gray-500 transition-all">Clear Data</button>
                                </div>
                            </div>
                            <div class="mt-8 lg:mt-0">
                                <div class="bg-white p-6 rounded-2xl border border-gray-200/80 h-full">
                                    <h3 class="text-xl font-semibold text-gray-800 mb-4 text-center">Breakfast List</h3>
                                    <div class="overflow-auto h-[450px] rounded-xl border border-gray-200">
                                        <table class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-green-50 sticky top-0">
                                                <tr><th class="px-6 py-3 text-left text-xs font-medium text-green-800 uppercase">Room</th><th class="px-6 py-3 text-left text-xs font-medium text-green-800 uppercase">Guest</th><th class="px-6 py-3 text-left text-xs font-medium text-green-800 uppercase">Amount</th></tr>
                                            </thead>
                                            <tbody id="ordersTableBody" class="bg-white divide-y divide-gray-100">
                                                <tr><td colspan="3" class="px-6 py-12 text-center text-gray-500">No data processed yet.</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

            <!-- KITCHEN PRODUCTS APP -->
            <div id="kitchen-app" class="app-content">
                <div id="kitchen-app-container" class="container mx-auto p-4 sm:p-6 md:p-8">
                     <header class="flex items-center gap-4 mb-8 no-print">
                         <div class="flex items-center justify-center gap-3 bg-pink-100 text-pink-800 px-6 py-3 rounded-3xl shadow-md">
                            <h1 class="text-3xl md:text-4xl font-bold text-purple-900">Kitchen List</h1>
                        </div>
                        <input type="date" id="kitchen-date-picker" class="py-3 px-4 border border-gray-300 rounded-xl focus:ring-4 focus:ring-pink-200">
                    </header>
                    <main class="bg-white p-6 sm:p-8 rounded-3xl shadow-xl">
                        <div id="input-section" class="grid grid-cols-1 md:grid-cols-2 md:gap-8 items-start no-print">
                            <div class="flex flex-col h-full">
                                <label for="kitchen_rawData" class="block text-base font-bold text-purple-800 mb-2">Data Input</label>
                                <textarea id="kitchen_rawData" rows="10" class="w-full p-4 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-fuchsia-500" placeholder="Paste Kitchen Products data..."></textarea>
                                <div class="mt-6 flex gap-4">
                                    <button id="kitchen_mainPrintBtn" class="bg-fuchsia-600 text-white font-bold py-3 px-6 rounded-2xl hover:bg-fuchsia-700 w-full">Print Report</button>
                                    <button id="kitchen_clearBtn" class="bg-fuchsia-100 text-fuchsia-800 font-bold py-3 px-6 rounded-2xl hover:bg-fuchsia-200 w-full">Clear</button>
                                </div>
                            </div>
                            <div class="bg-fuchsia-50 p-6 rounded-2xl mt-6 md:mt-0">
                                <h3 class="font-bold text-purple-800 mb-4">Instructions</h3>
                                <p class="text-gray-700">Paste the Daily Kitchen Products report from Mews/Rezlynx to generate the visual list.</p>
                            </div>
                        </div>
                        <div id="kitchen_error-message" class="hidden mt-6 p-4 bg-pink-100 text-pink-700 border border-pink-300 rounded-2xl">Parsing Error.</div>
                        <h2 id="reportTitle" class="text-2xl font-bold text-center my-4 hidden">Kitchen List</h2>
                        <div id="results" class="mt-8"></div>
                    </main>
                </div>
            </div>

            <!-- HOUSEKEEPING (HK) APP -->
            <div id="hk-app" class="app-content">
                <div class="container mx-auto my-10 max-w-5xl no-print">
                    <header class="flex items-center gap-4 mb-6">
                         <div class="flex items-center justify-center gap-3 bg-sky-100 text-sky-800 px-6 py-3 rounded-3xl hover:bg-sky-200 transition duration-150 shadow-md">
                            <h1 class="text-4xl font-extrabold text-center text-sky-700">Housekeeping Plan</h1>
                        </div>
                        <div class="relative">
                            <input type="date" id="hk-date-picker" class="w-full py-3 px-4 border border-gray-300 bg-white rounded-xl focus:ring-4 focus:ring-sky-200 transition duration-200 text-base appearance-none">
                        </div>
                    </header>
                    <div class="control-area mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="md:col-span-1 flex flex-col justify-start">
                                <h2 class="text-xl font-extrabold text-sky-700 mb-4">Report Details</h2>
                                <label for="reportDate" class="block text-base font-semibold text-gray-700 mb-2">Report Date:</label>
                                <input type="date" id="reportDate" class="w-full p-4 border-2 border-cyan-300 bg-cyan-50 rounded-2xl text-cyan-700 font-bold focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition shadow-inner">
                                <div class="mt-4 flex flex-col gap-3">
                                    <button id="clearDataBtn" class="w-full bg-red-500 text-white font-extrabold py-3 px-6 rounded-2xl hover:bg-red-600 transition duration-300">Clear Data</button>
                                    <button id="printBtn" class="w-full bg-cyan-500 text-white font-extrabold py-3 px-8 rounded-2xl hover:bg-cyan-600 transition duration-300">Print Checklist</button>
                                    <div id="status" class="text-center mt-2 text-sky-600 font-medium text-sm"></div>
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label for="dataText" class="block text-xl font-extrabold text-sky-700 mb-4">Reservation Data (Paste Here)</label>
                                <textarea id="dataText" rows="12" placeholder="Paste Rezlynx House Status report here..." class="w-full p-4 border border-sky-300 rounded-2xl focus:outline-none focus:ring-2 focus:ring-sky-500 resize-none min-h-[300px]"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="control-area mt-6">
                        <h2 class="text-2xl font-extrabold text-sky-700 mb-6 text-center">Print Options & Customization</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div class="p-5 bg-sky-50 rounded-2xl shadow-lg border border-sky-200">
                                <h3 class="text-xl font-bold text-sky-700 mb-4">Table Rows</h3>
                                <div class="grid grid-cols-2 gap-4 text-sm md:text-base" id="rowCheckboxes">
                                    <div class="flex items-center"><input type="checkbox" id="showUsedLastNightRow" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showUsedLastNightRow" class="ml-2">Used Last Night</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showArrivingTodayRow" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showArrivingTodayRow" class="ml-2">Arriving Today</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showGuestsRow" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showGuestsRow" class="ml-2">Guests</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showPetRow" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showPetRow" class="ml-2">Pet</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showTwinRow" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showTwinRow" class="ml-2">Twin</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showDaybedRow" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showDaybedRow" class="ml-2">Daybed</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showTrundleRow" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showTrundleRow" class="ml-2">Trundle</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showExtrasRow" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showExtrasRow" class="ml-2 font-bold">Extra</label></div>
                                </div>
                            </div>
                            <div class="p-5 bg-sky-50 rounded-2xl shadow-lg border border-sky-200">
                                <h3 class="text-xl font-bold text-sky-700 mb-4">Info & Lists</h3>
                                <div class="grid grid-cols-2 gap-4 text-sm md:text-base" id="listCheckboxes">
                                    <div class="flex items-center"><input type="checkbox" id="showDepartingRoomInfo" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showDepartingRoomInfo" class="ml-2">Departing Info</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showStayingRoomInfo" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showStayingRoomInfo" class="ml-2">Staying Info</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showStayingRoomsList" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showStayingRoomsList" class="ml-2">Staying List</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showPetRoomsList" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showPetRoomsList" class="ml-2">Pet List</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showTwinRoomsList" class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showTwinRoomsList" class="ml-2">Twin List</label></div>
                                    <div class="flex items-center"><input type="checkbox" id="showExtrasRoomsList" checked class="form-checkbox h-5 w-5 text-sky-500 rounded-md"><label for="showExtrasRoomsList" class="ml-2">Extras List</label></div>
                                </div>
                            </div>
                             <div class="p-5 bg-cyan-50 rounded-2xl shadow-lg border border-cyan-200 flex flex-col items-center justify-center">
                                <h3 id="sparkleModeTitle" class="text-xl font-bold text-cyan-700 cursor-pointer hover:text-cyan-900 transition duration-150 inline-block p-1 rounded">Work Mode</h3>
                                <div id="sparkleOptionsContainer" class="hidden flex flex-col gap-4 w-full mt-4">
                                    <div class="flex items-center justify-between p-3 bg-white rounded-xl border border-cyan-200 shadow-sm">
                                        <span class="text-gray-700 font-medium">Change Checkmark:</span>
                                        <button id="changeTickBtn" class="font-bold text-sky-600 text-2xl">‚úîÔ∏è</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="no-print"><div id="output-container" class="container mx-auto p-4"><div id="placeholder" class="text-center text-gray-500 p-10">Your generated cleaning report will appear here.</div></div></div>
                <div id="print-table-container" style="display: none;"></div>
            </div>

            <!-- FRONT HALL APP (NEW) -->
            <div id="fronthall-app" class="app-content">
                <div class="container mx-auto px-4 py-8 lg:py-10 no-print">
                    <header class="flex flex-col md:flex-row items-center justify-between gap-6 mb-8">
                        <div class="inline-flex items-center justify-center gap-3 bg-orange-100 text-orange-800 px-8 py-4 rounded-3xl shadow-md">
                             <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">Front Hall üõéÔ∏è</h1>
                        </div>
                        <div class="flex items-center gap-3">
                            <label class="font-bold text-gray-700">Date:</label>
                            <input type="date" id="fh-date-picker" class="py-3 px-4 border border-gray-300 bg-white rounded-xl focus:ring-4 focus:ring-orange-200 transition duration-200 shadow-sm">
                        </div>
                    </header>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                         <!-- Input Area -->
                        <div class="lg:col-span-1 flex flex-col gap-4">
                            <div class="bg-white p-6 rounded-3xl border border-orange-200 shadow-lg">
                                <label for="fh-data-input" class="block text-lg font-bold text-gray-800 mb-2">Paste Report Data</label>
                                <textarea id="fh-data-input" oninput="fh_processData()" rows="8" class="w-full p-4 bg-orange-50/50 border border-orange-200 rounded-2xl focus:ring-2 focus:ring-orange-400 focus:border-orange-500 transition resize-none" placeholder="Paste Rezlynx House Status data here..."></textarea>
                                <div class="mt-4 flex gap-3">
                                     <button onclick="fh_printCurrentView()" class="flex-1 bg-gray-800 text-white font-bold py-3 rounded-xl hover:bg-gray-900 transition shadow-md flex items-center justify-center gap-2">
                                         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                                         Print List
                                     </button>
                                     <button onclick="fh_clearData()" class="px-6 bg-gray-200 text-gray-600 font-bold py-3 rounded-xl hover:bg-gray-300 transition">Clear</button>
                                </div>
                            </div>
                            <!-- Legend -->
                            <div class="bg-white p-5 rounded-2xl border border-gray-100 shadow-sm">
                                <h3 class="font-bold text-gray-700 mb-3 text-sm uppercase tracking-wide">Key</h3>
                                <div class="flex flex-wrap gap-2">
                                    <span class="source-badge source-booking">Booking.com</span>
                                    <span class="source-expedia">Expedia</span>
                                    <span class="source-direct">Direct</span>
                                    <span class="px-2 py-1 bg-red-100 text-red-800 rounded-md text-xs font-bold border border-red-200">üí≥ VCC Alert</span>
                                </div>
                            </div>
                        </div>

                        <!-- Results Area -->
                        <div class="lg:col-span-2">
                             <div class="flex items-center gap-4 mb-4">
                                <button onclick="fh_switchView('arrivals')" id="btn-view-arr" class="flex-1 py-3 font-bold rounded-xl transition bg-orange-500 text-white shadow-md">Arrivals</button>
                                <button onclick="fh_switchView('departures')" id="btn-view-dep" class="flex-1 py-3 font-bold rounded-xl transition bg-white text-gray-600 border border-gray-200 hover:bg-gray-50">Departures</button>
                             </div>

                             <div id="fh-results-container" class="bg-white p-6 rounded-3xl border border-gray-200 shadow-xl min-h-[400px]">
                                 <div id="fh-placeholder" class="h-full flex flex-col items-center justify-center text-gray-400 opacity-60 mt-10">
                                     <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                                     <p class="mt-4 font-medium">Paste data to generate lists</p>
                                 </div>
                                 <div id="fh-list-content" class="hidden">
                                     <!-- Dynamic Content -->
                                 </div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- SUPER APP NAVIGATION LOGIC ---
        document.addEventListener('DOMContentLoaded', function() {
            const navButtons = document.querySelectorAll('#main-nav .nav-button');
            const appContents = document.querySelectorAll('.app-content');

            navButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.dataset.target;
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    appContents.forEach(content => {
                        if (content.id === targetId) {
                            content.classList.add('active');
                        } else {
                            content.classList.remove('active');
                        }
                    });
                });
            });

             // Initialize all app scripts
            breakfast_init();
            kitchen_init();
            hk_init();
            // Front Hall init handled by inline global scope below
        });

        // --- BREAKFAST TRACKER SCRIPT ---
        let breakfast_detectedDate = null; 
        function breakfast_init() { }
        function breakfast_calculateTotal() {
            let data = document.getElementById('orderData').value;
            const dateMatch = data.match(/(\d{2})\/([A-Za-z]{3})\/(\d{4})/);
            if (dateMatch) {
                const [_, day, monthStr, year] = dateMatch;
                const months = {Jan:0, Feb:1, Mar:2, Apr:3, May:4, Jun:5, Jul:6, Aug:7, Sep:8, Oct:9, Nov:10, Dec:11};
                breakfast_detectedDate = new Date(year, months[monthStr], day);
            }
            const tableBody = document.getElementById('ordersTableBody');
            tableBody.innerHTML = '';
            const lines = data.split('\n');
            const orders = {}; 
            let totalBreakfasts = 0;
            let currentRoom = null;
            let currentGuest = null;
            const rowRegex = /^(\d{3})\s+(BK\S+)\s+(.+?)\s+BREAKFAST/;
            const quantityRegex = /\b(\d+)\s+(\d{2}\/[A-Za-z]{3}\/\d{4})/;
            lines.forEach(line => {
                line = line.trim();
                const match = line.match(rowRegex);
                if (match) {
                    currentRoom = match[1];
                    currentGuest = match[3].trim();
                }
                const qMatch = line.match(quantityRegex);
                if (qMatch && currentRoom && currentGuest) {
                    const qty = parseInt(qMatch[1], 10);
                    const key = `${currentRoom}|${currentGuest}`;
                    if (!orders[key]) orders[key] = 0;
                    orders[key] += qty;
                }
            });
            const orderList = Object.keys(orders).map(key => {
                const [room, guest] = key.split('|');
                return { room, guest, amount: orders[key] };
            });
            orderList.sort((a, b) => parseInt(a.room) - parseInt(b.room));
            if (orderList.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="3" class="px-6 py-12 text-center text-gray-500"><span>No breakfast orders found.</span></td></tr>`;
                document.getElementById('totalAmount').textContent = '0';
                return;
            }
            orderList.forEach(order => {
                totalBreakfasts += order.amount;
                const row = document.createElement('tr');
                row.innerHTML = `<td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${order.room}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${order.guest}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${order.amount}</td>`;
                tableBody.appendChild(row);
            });
            document.getElementById('totalAmount').textContent = totalBreakfasts;
        }
        function breakfast_clearData() { document.getElementById('orderData').value = ''; document.getElementById('totalAmount').textContent = '0'; document.getElementById('ordersTableBody').innerHTML = `<tr><td colspan="3" class="px-6 py-12 text-center text-gray-500"><span>No data processed yet.</span></td></tr>`; }
        function breakfast_print() {
            const printDate = breakfast_detectedDate || new Date();
            breakfast_printTable(printDate);
        }
        function breakfast_printTable(date) {
             const tableBody = document.getElementById('ordersTableBody');
             if (!tableBody || tableBody.children[0].textContent.includes('No data')) return;
             const total = document.getElementById('totalAmount').textContent;
             const dateStr = date.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
             
             // Extract data
             const rows = Array.from(tableBody.querySelectorAll('tr')).map(r => {
                 const cells = r.querySelectorAll('td');
                 return cells.length >= 3 ? { r: cells[0].textContent, g: cells[1].textContent, a: cells[2].textContent } : null;
             }).filter(Boolean);

             const floors = [
                 {t:'Ground Floor', d: rows.filter(o=>parseInt(o.r)<=6)},
                 {t:'First Floor', d: rows.filter(o=>parseInt(o.r)>=101 && parseInt(o.r)<=130)},
                 {t:'Second Floor', d: rows.filter(o=>parseInt(o.r)>=201 && parseInt(o.r)<=230)}
             ];

             const printW = window.open('', '_blank');
             printW.document.write(`<html><head><title>Breakfast List</title><style>
                 body{font-family:sans-serif;padding:20px;}
                 h1{text-align:center;color:#166534;margin-bottom:5px;}
                 .meta{text-align:center;margin-bottom:20px;color:#166534;font-weight:bold;}
                 .col-container{display:flex;gap:20px;}
                 .col{flex:1;}
                 h3{border-bottom:2px solid #ddd;padding-bottom:5px;margin-top:0;}
                 table{width:100%;border-collapse:collapse;margin-bottom:15px;}
                 th,td{border:1px solid #ccc;padding:5px;text-align:left;}
                 th{background:#f0fdf4;}
                 td:first-child{font-weight:bold;width:15%;text-align:center;}
                 td:last-child{text-align:center;}
             </style></head><body>
                 <h1>Breakfast List</h1>
                 <div class="meta">${dateStr} | Total: ${total}</div>
                 <div class="col-container">
                     <div class="col">
                         ${floors[0].d.length ? `<h3>${floors[0].t}</h3><table><tr><th>Room</th><th>Guest</th><th>Qty</th></tr>${floors[0].d.map(x=>`<tr><td>${x.r}</td><td>${x.g}</td><td>${x.a}</td></tr>`).join('')}</table>` : ''}
                         ${floors[1].d.length ? `<h3>${floors[1].t}</h3><table><tr><th>Room</th><th>Guest</th><th>Qty</th></tr>${floors[1].d.map(x=>`<tr><td>${x.r}</td><td>${x.g}</td><td>${x.a}</td></tr>`).join('')}</table>` : ''}
                     </div>
                     <div class="col">
                         ${floors[2].d.length ? `<h3>${floors[2].t}</h3><table><tr><th>Room</th><th>Guest</th><th>Qty</th></tr>${floors[2].d.map(x=>`<tr><td>${x.r}</td><td>${x.g}</td><td>${x.a}</td></tr>`).join('')}</table>` : ''}
                     </div>
                 </div>
             </body></html>`);
             printW.document.close();
             setTimeout(()=>printW.print(), 200);
        }

        // --- KITCHEN PRODUCTS SCRIPT ---
        function kitchen_init() {
            const rawDataInput = document.getElementById('kitchen_rawData');
            document.getElementById('kitchen_mainPrintBtn').addEventListener('click', () => { if (!document.querySelector('#kitchen-app #results').innerHTML.trim()) { alert("Please paste data to generate a report before printing."); } else { window.print(); } });
            document.getElementById('kitchen_clearBtn').addEventListener('click', () => { rawDataInput.value = ''; document.querySelector('#kitchen-app #results').innerHTML = ''; });
            rawDataInput.addEventListener('input', () => {
                const text = rawDataInput.value;
                const dates = (text.match(/\d{2}\/\d{2}\/\d{4}/g) || []).filter((v,i,a)=>a.indexOf(v)===i).sort((a,b)=> new Date(a.split('/').reverse().join('-')) - new Date(b.split('/').reverse().join('-')));
                if(!dates.length) return;
                let bk = [];
                text.split('\n').forEach(l => {
                    if(l.toLowerCase().includes('all products') || l.toLowerCase().includes('breakfast')) {
                        const nums = l.match(/\b\d+\b/g);
                        if(nums && nums.length >= dates.length) bk = nums.slice(-dates.length);
                    }
                });
                const res = document.querySelector('#kitchen-app #results');
                res.innerHTML = `<table class="w-full"><thead><tr><th>Date</th><th>Breakfasts</th></tr></thead><tbody>${dates.map((d,i)=>`<tr><td>${d}</td><td>${bk[i]||0} üç≥</td></tr>`).join('')}</tbody></table>`;
            });
        }

        // --- HOUSEKEEPING SCRIPT ---
        function hk_init() {
            const dataTextInput = document.getElementById('dataText');
            document.getElementById('printBtn').addEventListener('click', () => window.print());
            document.getElementById('clearDataBtn').addEventListener('click', () => { dataTextInput.value = ''; document.getElementById('output-container').innerHTML = ''; });
            dataTextInput.addEventListener('input', () => {
                const raw = dataTextInput.value;
                if(raw.length < 10) return;
                const dateMatch = raw.match(/(\d{2})\/([A-Za-z]{3})\/(\d{4})/);
                if(dateMatch) {
                    const months = {Jan:'01', Feb:'02', Mar:'03', Apr:'04', May:'05', Jun:'06', Jul:'07', Aug:'08', Sep:'09', Oct:'10', Nov:'11', Dec:'12'};
                    document.getElementById('reportDate').value = `${dateMatch[3]}-${months[dateMatch[2]]}-${dateMatch[1]}`;
                    document.getElementById('hk-date-picker').value = document.getElementById('reportDate').value;
                    document.getElementById('output-container').innerHTML = '<div class="p-4 bg-green-100 text-green-700 rounded-xl text-center font-bold">Data detected! Click Print Checklist to generate formatted report.</div>';
                }
            });
        }

        // --- FRONT HALL APP SCRIPT (NEW) ---
        let fh_parsedData = { arrivals: [], departures: [] };
        let fh_currentView = 'arrivals'; 

        function fh_clearData() {
            document.getElementById('fh-data-input').value = '';
            document.getElementById('fh-list-content').classList.add('hidden');
            document.getElementById('fh-placeholder').classList.remove('hidden');
            fh_parsedData = { arrivals: [], departures: [] };
        }

        function fh_processData() {
            const raw = document.getElementById('fh-data-input').value;
            const selectedDateVal = document.getElementById('fh-date-picker').value;
            
            let reportDate = selectedDateVal ? new Date(selectedDateVal) : new Date();
            if (!selectedDateVal) {
                const dateMatch = raw.match(/(\d{2})\/([A-Za-z]{3})\/(\d{4})/);
                if(dateMatch) {
                    const months = {Jan:0, Feb:1, Mar:2, Apr:3, May:4, Jun:5, Jul:6, Aug:7, Sep:8, Oct:9, Nov:10, Dec:11};
                    reportDate = new Date(dateMatch[3], months[dateMatch[2]], dateMatch[1]);
                    const mStr = (reportDate.getMonth()+1).toString().padStart(2,'0');
                    const dStr = reportDate.getDate().toString().padStart(2,'0');
                    document.getElementById('fh-date-picker').value = `${reportDate.getFullYear()}-${mStr}-${dStr}`;
                }
            }

            const lines = raw.split('\n');
            const processedRooms = [];

            const processBlock = (blockStr) => {
                 const mainLineMatch = blockStr.match(/(\d{2}\/[A-Za-z]{3}\/\d{4}).*?(\d{2}\/[A-Za-z]{3}\/\d{4}).*?\b(\d{3})\b/);
                 if(!mainLineMatch) return null;

                 const roomCode = mainLineMatch[3];
                 let name = blockStr.substring(0, blockStr.indexOf(mainLineMatch[1])).trim().replace(/\t/g, ' ');
                 
                 let source = 'Direct';
                 if(blockStr.includes('Booking.com') || blockStr.includes('BOOK_')) source = 'Booking.com';
                 else if(blockStr.includes('Expedia') || blockStr.includes('EXP_')) source = 'Expedia';
                 else if(blockStr.includes('Hotel Website')) source = 'Direct';
                 
                 const sourceMatch = blockStr.match(/S:\s*([A-Za-z\.]+)/);
                 if(sourceMatch) {
                     const s = sourceMatch[1].toLowerCase();
                     if(s.includes('booking')) source = 'Booking.com';
                     else if(s.includes('expedia')) source = 'Expedia';
                 }

                 // VCC Logic
                 const hasVCC = /virtual\s*card|virtual\s*credit\s*card|vcc|prepayment/i.test(blockStr);
                 
                 const arrDateStr = mainLineMatch[1];
                 const depDateStr = mainLineMatch[2];
                 
                 // EXTRACTING NOTES & EXTRAS
                 const importantHeaders = [
                    "Public Notes", "Private Notes", "Food & Beverage Notes",
                    "Housekeeping Notes", "Confirmation Notes", "Assistance Required",
                    "Car Reg", "Imported PMS Ref"
                 ];

                 let foundNotes = [];

                 // 1. Get Extras
                 const extrasMatch = blockStr.match(/Extras:\s*([\s\S]*?)(?=---ImportEnd)/);
                 if(extrasMatch && extrasMatch[1].trim()) {
                     const lines = extrasMatch[1].split('\n').filter(l=>l.trim());
                     lines.forEach(l => foundNotes.push({type:'Extra', text:l.trim().replace(/,,/g, ' ' )}));
                 }

                 // 2. Get specific line notes with cleaning
                 importantHeaders.forEach(h => {
                    const re = new RegExp(`${h}:\\s*(.+)`, 'i');
                    const m = blockStr.match(re);
                    if(m && m[1].trim()) {
                        let cleanedText = m[1].trim();
                        // Remove block if fully captured
                        cleanedText = cleanedText.replace(/---ImportStart---[\s\S]*?---ImportEnd---/g, '');
                        // Remove header line if partially captured or isolated
                        cleanedText = cleanedText.replace(/---ImportStart---.*/g, '');
                        // Remove specific tag if leftover
                        cleanedText = cleanedText.replace(/PMSImportResRef.*/g, '');
                        
                        cleanedText = cleanedText.trim();
                        if(cleanedText) {
                            foundNotes.push({type:'Note', label: h, text: cleanedText});
                        }
                    }
                 });

                 return {
                     room: roomCode,
                     name: name,
                     source: source,
                     hasVCC: hasVCC,
                     arrDate: arrDateStr,
                     depDate: depDateStr,
                     notes: foundNotes
                 };
            };

            let currentBlock = "";
            const resLineRegex = /\d{2}\/[A-Za-z]{3}\/\d{4}.*\d{2}\/[A-Za-z]{3}\/\d{4}.*\b\d{3}\b/;

            lines.forEach(line => {
                if(resLineRegex.test(line)) {
                    if(currentBlock) {
                        const r = processBlock(currentBlock);
                        if(r) processedRooms.push(r);
                    }
                    currentBlock = line;
                } else {
                    currentBlock += "\n" + line;
                }
            });
            if(currentBlock) {
                const r = processBlock(currentBlock);
                if(r) processedRooms.push(r);
            }

            const monthsShort = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
            const targetDay = String(reportDate.getDate()).padStart(2,'0');
            const targetMonth = monthsShort[reportDate.getMonth()];
            const targetYear = reportDate.getFullYear();
            const targetDateStr = `${targetDay}/${targetMonth}/${targetYear}`;

            fh_parsedData.arrivals = processedRooms.filter(r => r.arrDate === targetDateStr).sort((a,b)=>parseInt(a.room)-parseInt(b.room));
            fh_parsedData.departures = processedRooms.filter(r => r.depDate === targetDateStr).sort((a,b)=>parseInt(a.room)-parseInt(b.room));

            fh_renderList();
        }

        function fh_switchView(view) {
            fh_currentView = view;
            const btnArr = document.getElementById('btn-view-arr');
            const btnDep = document.getElementById('btn-view-dep');
            
            if(view === 'arrivals') {
                btnArr.className = "flex-1 py-3 font-bold rounded-xl transition bg-orange-500 text-white shadow-md";
                btnDep.className = "flex-1 py-3 font-bold rounded-xl transition bg-white text-gray-600 border border-gray-200 hover:bg-gray-50";
            } else {
                btnDep.className = "flex-1 py-3 font-bold rounded-xl transition bg-orange-500 text-white shadow-md";
                btnArr.className = "flex-1 py-3 font-bold rounded-xl transition bg-white text-gray-600 border border-gray-200 hover:bg-gray-50";
            }
            fh_renderList();
        }

        function fh_renderList() {
            const container = document.getElementById('fh-list-content');
            const placeholder = document.getElementById('fh-placeholder');
            const data = fh_currentView === 'arrivals' ? fh_parsedData.arrivals : fh_parsedData.departures;

            if(data.length === 0 && fh_parsedData.arrivals.length === 0 && fh_parsedData.departures.length === 0) {
                 placeholder.classList.remove('hidden');
                 container.classList.add('hidden');
                 return;
            }

            placeholder.classList.add('hidden');
            container.classList.remove('hidden');
            container.innerHTML = '';

            const createTable = (rooms, title) => {
                if(!rooms.length) return '';
                return `
                <div class="mb-6">
                    <h3 class="text-xl font-bold text-gray-700 border-b-2 border-orange-100 pb-2 mb-3">${title}</h3>
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-gray-50 text-gray-500 text-sm uppercase">
                                <th class="p-3 font-bold rounded-l-lg w-20">Room</th>
                                <th class="p-3 font-bold w-48">Guest Name</th>
                                <th class="p-3 font-bold w-24">Dep.</th>
                                <th class="p-3 font-bold w-24">Source</th>
                                <th class="p-3 font-bold rounded-r-lg">Notes & Extras</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            ${rooms.map(r => {
                                let badgeClass = 'source-other';
                                if(r.source === 'Booking.com') badgeClass = 'source-booking';
                                else if(r.source === 'Expedia') badgeClass = 'source-expedia';
                                else if(r.source === 'Direct') badgeClass = 'source-direct';
                                
                                let notesHtml = '';
                                if(r.hasVCC) notesHtml += '<span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded-md font-bold border border-red-200 text-xs mb-1">üí≥ VCC Alert</span><br>';
                                
                                r.notes.forEach(n => {
                                    if(n.type === 'Extra') {
                                        notesHtml += `<span class="note-line"><strong>Extra:</strong> ${n.text}</span>`;
                                    } else {
                                        notesHtml += `<span class="note-line"><strong>${n.label}:</strong> ${n.text}</span>`;
                                    }
                                });

                                return `
                                <tr class="hover:bg-orange-50 transition">
                                    <td class="p-3 font-bold text-lg text-gray-800 align-top">${r.room}</td>
                                    <td class="p-3 font-medium text-gray-700 align-top">${r.name}</td>
                                    <td class="p-3 font-medium text-gray-600 text-sm align-top">${r.depDate}</td>
                                    <td class="p-3 align-top"><span class="source-badge ${badgeClass}">${r.source}</span></td>
                                    <td class="p-3 align-top">${notesHtml}</td>
                                </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>`;
            };

            const floors = [
                 {t:'Ground Floor', d: data.filter(o=>parseInt(o.room)<=6)},
                 {t:'First Floor', d: data.filter(o=>parseInt(o.room)>=101 && parseInt(o.room)<=130)},
                 {t:'Second Floor', d: data.filter(o=>parseInt(o.room)>=201 && parseInt(o.room)<=230)}
            ];

            let html = '';
            if(!data.length) {
                html = `<div class="text-center py-10 text-gray-500">No ${fh_currentView} found for this date.</div>`;
            } else {
                floors.forEach(f => {
                    html += createTable(f.d, f.t);
                });
            }
            container.innerHTML = html;
        }

        function fh_printCurrentView() {
            const data = fh_currentView === 'arrivals' ? fh_parsedData.arrivals : fh_parsedData.departures;
            const dateVal = document.getElementById('fh-date-picker').value;
            const dateObj = new Date(dateVal);
            const dateStr = dateObj.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
            // Dynamic Title based on view
            const titleText = fh_currentView === 'arrivals' ? 'Arrival List' : 'Departure List';
            
            const floors = [
                 {t:'Ground Floor', d: data.filter(o=>parseInt(o.room)<=6)},
                 {t:'First Floor', d: data.filter(o=>parseInt(o.room)>=101 && parseInt(o.room)<=130)},
                 {t:'Second Floor', d: data.filter(o=>parseInt(o.room)>=201 && parseInt(o.room)<=230)}
            ];
            
            // Generate HTML for a single floor's table
            const createPrintTable = (title, rooms) => {
                if(!rooms.length) return '';
                return `
                <div class="floor-header">${title}</div>
                <table>
                    <thead><tr><th style="width:10%">Room</th><th style="width:25%">Guest</th><th style="width:15%">Source</th><th>Notes</th></tr></thead>
                    <tbody>
                        ${rooms.map(r => {
                            let badgeStyle = "font-size:8pt; padding:1px 4px; border-radius:4px; font-weight:bold; color:white;";
                            if(r.source==='Booking.com') badgeStyle += "background:#003580;";
                            else if(r.source==='Expedia') badgeStyle += "background:#FFC20E; color:black;";
                            else if(r.source==='Direct') badgeStyle += "background:#059669;";
                            else badgeStyle += "background:#6b7280;";

                            let notesHtml = '';
                            if(r.hasVCC) notesHtml += '<span class="vcc-alert">üí≥ VCC Alert</span> ';
                            r.notes.forEach(n => {
                                // Unified notes style for print
                                if(n.type==='Extra') notesHtml += `<div><strong>Extra:</strong> ${n.text}</div>`;
                                else notesHtml += `<div><strong>${n.label}:</strong> ${n.text}</div>`;
                            });

                            return `<tr>
                                <td style="text-align:center; font-weight:bold;">${r.room}</td>
                                <td>${r.name}</td>
                                <td><span style="${badgeStyle}">${r.source}</span></td>
                                <td>${notesHtml}</td>
                            </tr>`;
                        }).join('')}
                    </tbody>
                </table>`;
            };

            const printW = window.open('', '_blank');
            printW.document.write(`<html><head><title>Front Hall List</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet"><style>
                @media print { @page { size: A4 landscape; margin: 10mm; } }
                body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact; print-color-adjust: exact; padding: 10px; }
                .print-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 3px solid #000; padding-bottom: 10px; }
                .print-title { background-color: #ffedd5; color: #c2410c; padding: 10px 30px; border-radius: 30px; font-weight: 800; font-size: 24pt; letter-spacing: -0.5px; }
                .print-meta { background-color: #ffedd5; color: #c2410c; padding: 10px 20px; border-radius: 10px; text-align: right; font-weight: 600; line-height: 1.4; }
                
                /* CHANGED: Removed column flex logic to stack vertically */
                .print-container { display: block; width: 100%; }
                
                .floor-header { text-align: center; font-style: italic; font-weight: 700; font-size: 14pt; margin: 15px 0 5px; color: #000; }
                table { width: 100%; border-collapse: collapse; margin-bottom: 15px; font-size: 9pt; }
                th, td { border: 1px solid #94a3b8; padding: 4px 6px; text-align: left; vertical-align: top; }
                th { background-color: #f1f5f9; font-weight: bold; color: #334155; }
                .vcc-alert { color: #dc2626; font-weight: bold; font-size: 8pt; border: 1px solid #dc2626; padding: 1px 3px; border-radius: 3px; display: inline-block; margin-bottom: 2px; }
            </style></head><body>
                <div class="print-header">
                    <div class="print-title">Front Hall - ${titleText}</div>
                    <div class="print-meta">
                        <div>${dateStr}</div>
                        <div>Total: ${data.length}</div>
                    </div>
                </div>
                <div class="print-container">
                    ${createPrintTable('Ground Floor', floors[0].d)}
                    ${createPrintTable('First Floor', floors[1].d)}
                    ${createPrintTable('Second Floor', floors[2].d)}
                </div>
            </body></html>`);
            printW.document.close();
            setTimeout(() => { printW.print(); printW.close(); }, 250);
        }

    </script>
</body>
</html>
